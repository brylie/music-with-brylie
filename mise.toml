[tools]
dprint = "latest"
ffmpeg = "7"
lefthook = "latest"
python = "3.13"
ruff = "latest"
tinytex = "latest"
uv = "latest"

[env._]

[env._.python]
venv = ".venv"

[tasks.setup]
description = "Install Python dependencies"
run = "uv sync"

[tasks.dev]
description = "Run development server"
run = "uv run python --version"

[tasks.render]
description = "Render a Manim scene in low quality (fast preview)"
run = "uv run manim -pql"

[tasks.render-hq]
description = "Render a Manim scene in high quality"
run = "uv run manim -pqh"

[tasks.test]
description = "Run tests with coverage"
run = "uv run pytest tests/ -v --cov=utils --cov-report=term-missing"

[tasks.test-watch]
description = "Run tests in watch mode"
run = "uv run pytest-watch tests/"

[tasks.lint]
description = "Run all linters (ruff + dprint)"
run = ["ruff check src/ tests/", "dprint check"]

[tasks.format]
description = "Format all code (ruff + dprint)"
run = ["ruff format src/ tests/", "ruff check --fix src/ tests/", "dprint fmt"]

[tasks.typecheck]
description = "Run mypy type checker"
run = "uv run mypy src/"

[tasks.ci]
description = "Run all CI checks (tests, lint, typecheck)"
run = ["mise run test", "mise run lint", "mise run typecheck"]
